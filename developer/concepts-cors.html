---
title: 'Entendiendo CORS'
description: 'En este tema, aprenderá sobre CORS y las restricciones integradas en la Web con respecto a la referencia cruzada de activos como videos, imágenes y scripts.'
parent: Developers
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>
  <section class="bcls-section">
    <h2 id="Overview">Descripción general</h2>
    <p>El intercambio de recursos de origen cruzado (CORS) es un mecanismo que permite que una página web realice solicitudes a otro dominio que no sea aquel desde el que se sirvió la página. Normalmente, los navegadores web prohibirían las solicitudes entre dominios. CORS define una forma en que los dominios pueden interactuar para determinar si permiten o no solicitudes de origen cruzado.</p>
    <aside class="bcls-aside bcls-aside--information">Tenga en cuenta que CORS es <strong>no</strong> habilitado por o relacionado con crossdomain.xml, que es un mecanismo para habilitar solicitudes entre dominios para aplicaciones Flash.</aside>
  </section>
  <section class="bcls-section">
    <h2 id="corsandbc">CORS y Brightcove</h2>
    <p>Hay tres casos en los que CORS se debe utilizar con los servicios / productos de Brightcove:</p>
    <ol>
      <li><strong>Subtítulos para videos</strong>: El archivo que contiene subtítulos para un video se puede almacenar en un dominio que no sea de Brightcove. Dado que el video en sí se publicará desde un dominio de Brightcove, esto provocará problemas entre dominios.</li>
      <li><strong>Brightcove Player y HLS</strong>: los <span class="video-cloud-only" translate="No">Brightcove Player's </span>El complemento HLS utiliza solicitudes AJAX para recuperar el manifiesto del video HLS y los segmentos individuales. Dado que estos recursos de HLS se pueden almacenar en cualquier dominio accesible de Internet, es probable que estos recursos se sirvan desde un servidor diferente (normalmente un dominio CDN) que desde el dominio de Brightcove que sirvió al reproductor. Esto volverá a causar problemas entre dominios.</li>
      <li><strong>Imágenes fijas y miniaturas de vídeo</strong>: para <a href="https://studio.support.brightcove.com/media/capturing-poster-and-thumbnail-images.html">capturar imágenes fijas y miniaturas de vídeo en Studio</a>, la reproducción de vídeo debe entregarse con encabezados CORS (que deben estar habilitados en la mayoría de los alojar CDN de forma predeterminada); si tiene una CDN personalizada o una que aún no hemos actualizado, la captura de imágenes no funcionará</li>
    </ol>
  </section>
  <section class="bcls-section">
    <h2 id="solution">Soluciones</h2>
    <p>La solución que Brightcove está utilizando en este momento implica configurar un <code translate="No">Access-Control-Allow-Origin</code> encabezado en el archivo de configuración del servidor de origen CDN. Es importante tener en cuenta que, dado que diferentes socios de CDN utilizan diferentes soluciones de servidor para entregar su contenido, la información del encabezado a continuación se ofrece como un ejemplo y no como un fragmento de código.</p>
    <p>Brightcove ha tenido éxito con la siguiente directiva de encabezado para las propiedades del servidor CDN interno:</p>
    <pre class="line-numbers">
<code class="language-apache" translate="No">&lt;FilesMatch ".(vtt|xml)$"&gt;
              Header set Access-Control-Allow-Headers: X-Requested-With
              Header add Access-Control-Allow-Origin: http://admin.brightcove.com
          &lt;/FilesMatch&gt;</code></pre>
    <p>A continuación se proporcionan breves explicaciones de la directiva:</p>
    <ul>
      <li><code translate="No">&lt;FilesMatch ".(vtt|xml)$"&gt;</code>: Este condicional establece el <code translate="No">Access-Control-Allow-Origin</code> encabezado solo en archivos vtt o xml. Las pruebas han confirmado que este encabezado no se envía con imágenes u otro contenido enviado por http.</li>
      <li><code translate="No">Header set Access-Control-Allow-Headers: X-Requested-With</code>: Este encabezado es necesario para <code translate="No">Access-Control-Allow-Origin</code> encabezado para que funcione, ya que la solicitud que realiza el jugador es un XmlHttpRequest.</li>
      <li><code translate="No">Header add Access-Control-Allow-Origin: http://admin.brightcove.com</code>: Este es el encabezado de control de acceso en sí mismo para permitir contenido del dominio indicado.</li>
    </ul>
    <h3>Habilitar CORS en Apache</h3>
    <p>Puede establecer un encabezado en la configuración de los servidores Apache para habilitar CORS. Coloque lo siguiente en el lugar apropiado <code translate="No">.conf</code> expediente:</p>
    <pre class="line-numbers">
<code class="language-bash" translate="No">Header set Access-Control-Allow-Origin "*"</code></pre>
    <p>En el ejemplo anterior, los asteriscos actúan como comodines y permiten el acceso a todos los dominios. El comodín también se puede reemplazar por <strong>uno</strong> dominio específico. Eso generalmente no funcionará para los reproductores de Brightcove, porque en muchos casos los activos residirán en múltiples dominios. Puede implementar otras soluciones para limitar el acceso a una lista blanca específica de dominios aceptables.</p>
    <h3>BYO CDN</h3>
    <p>Si es un cliente con un BYO CDN y tiene problemas entre dominios, debe comunicarse con su CDN para obtener ayuda para configurar CORS para su cuenta. Estos son los ajustes que recomendamos:</p>
    <ul>
      <li>Access-Control-Allow-Headers: X-Solicitado-Con</li>
      <li>Acceso-Control-Permitir-Origen: *</li>
      <li>formatos de archivo: m3u8 m3u ts xml dfxp vtt mpd m4f mp4 jpg png</li>
    </ul>
    <h3>Requisitos de autorización de tokens</h3>
    <p>En el caso de que se requiera la autorización del token, se deben realizar modificaciones en la solución anterior. En el caso de la autorización de token, el modelo de seguridad de CORS específicamente no permite el uso de la <code translate="No">*</code> carácter como un valor para el <code translate="No">Access-Control-Allow-Origin</code> encabezado de respuesta. Además, el encabezado de <code translate="No">Access-Control-Allow-Credentials</code> respuesta es obligatorio y debe establecerse en true.</p>
    <p>Una directiva de encabezado actualizada para la autorización de token es:</p>
    <pre class="line-numbers">
<code class="language-apache" translate="No">&lt;FilesMatch ".(m3u8 | m3u | ts)$"&gt;
        # with AJAX withCredentials=true (cookies sent, SSL allowed...)
        SetEnvIfNoCase ORIGIN (.*) ORIGIN=$1
        Header set Access-Control-Allow-Origin "%{ORIGIN}e"
        Header set Access-Control-Allow-Credentials "true"
        RewriteEngine On
        RewriteCond %{REQUEST_METHOD} OPTIONS
        RewriteRule ^(.*)$ $1 [R=200,L,E=HTTP_ORIGIN:%{HTTP:ORIGIN}]
  &lt;/FilesMatch&gt;</code></pre>
    <p>Los siguientes puntos detallan las diferencias con la solución anterior:</p>
    <ul>
      <li>La directiva consulta la solicitud entrante por la presencia de un encabezado de Origin y, si ese encabezado está presente (normalmente lo está), establece su valor en una variable denominada <code translate="No">ORIGIN</code>: <code translate="No">SetEnvIfNoCase ORIGIN (.*) ORIGIN=$1</code></li>
      <li>El valor del encabezado de <code translate="No">Access-Control-Allow-Origin</code> respuesta se establece en el valor de la <code translate="No">ORIGIN</code> variable recién creada: <code translate="No">Header set Access-Control-Allow-Origin "%{ORIGIN}e"</code> <aside class="bcls-aside bcls-aside--information"> <code translate="No">e</code> Se requiere, para indicar que se trata de una variable de entorno.</aside>
      </li>
      <li>El <code translate="No">Access-Control-Allow-Credentials</code> encabezado debe establecerse en <code translate="No">true</code>: <code translate="No">Header set Access-Control-Allow-Credentials "true"</code></li>
    </ul>
  </section>
  <section class="bcls-section">
    <h2 id="hls">HLS y CORS</h2>
    <p>En algunos entornos (como Amazon S3), puede especificar una configuración CORS para HLS. Lo siguiente configura CORS para permitir la reproducción de HLS.</p>
    <pre class="line-numbers">
<code class="language-apache" translate="No">&lt;CORSConfiguration&gt;
      &lt;CORSRule&gt;
      &lt;AllowedOrigin&gt;*&lt;/AllowedOrigin&gt;
      &lt;AllowedMethod&gt;GET&lt;/AllowedMethod&gt;
      &lt;/CORSRule&gt;
&lt;/CORSConfiguration&gt;</code></pre>
    <p>Para obtener más información específica de Amazon S3, consulte <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/cors.html#how-do-i-enable-cors">Habilitación del uso compartido de recursos entre orígenes</a>.</p>
    <p>Aunque es tangencial a CORS, el navegador del cliente debe aceptar todas las cookies de sesión para que la entrega de contenido de HLS autorizado por token funcione correctamente. Si bien algunos navegadores cliente, como Google Chrome y Mozilla Firefox, aceptan cookies de sesión de forma predeterminada, otros navegadores, como Internet Explorer, no lo hacen, por lo que el usuario debe habilitar esta opción.</p>
  </section>
</article>